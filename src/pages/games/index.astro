---
import TagLinks from "@components/TagLinks.astro";
import Layout from "@layouts/Layout.astro";
import { getTags, sortByDate } from "@lib/util";
import { getCollection } from "astro:content";

const games = sortByDate(await getCollection("games"));
---

<Layout title="games">
	<section>
		<h1>games</h1>

		{
			games.map(async (game) => {
				const tags = await getTags(game);

				return (
					<article class="content-item">
						<h2><a href={"/games/" + game.id}>{ game.data.title }</a></h2>
						<div class="game-details">
							<p><TagLinks tags={tags} /></p>
							{ (game.data.jam) ?
								<a href={game.data.jam.link}>{ game.data.jam.name }</a>
								: undefined
							}
						</div>
						<p>{ game.data.description }</p>
					</article>
				);
			})
		}
	</section>
</Layout>

<style>
	body {
		--theme: var(--games);
	}

	article {
		& .game-details {
			display: flex;
			flex-wrap: wrap;
			gap: 0 1em;
			margin: .25em 0;

			& > p {
				margin: 0;
			}
		}
	}
</style>
